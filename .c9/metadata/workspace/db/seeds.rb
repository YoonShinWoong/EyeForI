{"changed":false,"filter":false,"title":"seeds.rb","tooltip":"/db/seeds.rb","value":"# This file should contain all the record creation needed to seed the database with its default values.\n# The data can then be loaded with the rake db:seed (or created alongside the db with db:setup).\n#\n# Examples:\n#\n#   cities = City.create([{ name: 'Chicago' }, { name: 'Copenhagen' }])\n#   Mayor.create(name: 'Emanuel', city: cities.first)\nNaver.configure do |config|\n  config.client_id     = \"3br6Cy8iz8_KWo5SnkQ1\"\n  config.client_secret = \"nCauY9hxXz\"\n  config.redirect_uri  = \"https://eyefori-woongsin94.c9users.io/oauth/callback\"\n  config.timeout = 10\n  config.debug = false\nend\n#김민석\nUser.create(usertype: \"parent\", username: \"kms\", email: \"dheldh66@icloud.com\", gender: \"남\", age: 24, telephone: \"\t01040197555\", password: \"121212\", password_confirmation: \"121212\")\nUser.create(usertype: \"teacher\", username: \"t_kms\", email: \"dheldh77@icloud.com\", gender: \"남\", age: 24, telephone: \"\t01040197555\", password: \"121212\", password_confirmation: \"121212\", kindergarden_id: \"9\")\n#윤신웅\nUser.create(usertype: \"parent\", username: \"woong\", email: \"woongsin94@naver.com\", gender: \"남\", age: 24, telephone: \"\t01012341234\", password: \"123123\", password_confirmation: \"123123\")\nUser.create(usertype: \"teacher\", username: \"t_woong\", email: \"woongsin942@naver.com\", gender: \"남\", age: 24, telephone: \"\t01041234235\", password: \"123123\", password_confirmation: \"123123\", kindergarden_id: \"9\")\n#이산하\nUser.create(usertype: \"parent\", username: \"lsh\", email: \"bluegisa@likelion.org\", gender: \"남\", age: 6, telephone: \"\t01011112222\", password: \"123456\", password_confirmation: \"123456\")\nUser.create(usertype: \"teacher\", username: \"t_lsh\", email: \"bluegisa12@gmail.com\", gender: \"남\", age: 6, telephone: \"\t01011112222\", password: \"123456\", password_confirmation: \"123456\", kindergarden_id: \"9\")\n#홍연주\nUser.create(usertype: \"parent\", username: \"yeonju\", email: \"hyj9785@likelion.org\", gender: \"여\", age: 22, telephone: \"\t01095903206\", password: \"123456\", password_confirmation: \"123456\")\nUser.create(usertype: \"teacher\", username: \"t_yeonju\", email: \"hyj9785@naver.com\", gender: \"여\", age: 22, telephone: \"\t01095903206\", password: \"123456\", password_confirmation: \"123456\", kindergarden_id: \"9\")\n#유재인\nUser.create(usertype: \"parent\", username: \"jaein\", email: \"y_jaein@naver.com\", gender: \"여\", age: 22, telephone: \"\t01089725447\", password: \"123456\", password_confirmation: \"123456\")\nUser.create(usertype: \"teacher\", username: \"t_jaein\", email: \"y_jaein@likelion.org\", gender: \"여\", age: 22, telephone: \"\t01089725447\", password: \"123456\", password_confirmation: \"123456\", kindergarden_id: \"9\")\n#김지연\nUser.create(usertype: \"parent\", username: \"kjy\", email: \"mineo3o@naver.com\", gender: \"여\", age: 24, telephone: \"\t01040197555\", password: \"123456\", password_confirmation: \"123456\")\nUser.create(usertype: \"teacher\", username: \"t_kjy\", email: \"mineo3o@likelion.org\", gender: \"여\", age: 24, telephone: \"\t01040197555\", password: \"123456\", password_confirmation: \"123456\", kindergarden_id: \"9\")\n\n#김민석 아이\nChild.create(name: \"김수한무\", age: 5, gender: \"남\", teacher_id: 2, parent_id: 1, kindergarden_id: 9, className: \"병아리반\", classNumber: 1 )\n#윤신웅 아이\nChild.create(name: \"윤이클로\", age: 5, gender: \"남\", teacher_id: 4, parent_id: 3, kindergarden_id: 9, className: \"병아리반\", classNumber: 1 )\n#이산하 아이\nChild.create(name: \"이마트\", age: 5, gender: \"남\", teacher_id: 6, parent_id: 5, kindergarden_id: 9, className: \"병아리반\", classNumber: 1 )\n#홍연주 아이\nChild.create(name: \"홍익대\", age: 5, gender: \"남\", teacher_id: 8, parent_id: 7, kindergarden_id: 9, className: \"병아리반\", classNumber: 1  )\n#유재인 아이\nChild.create(name: \"유튜브\", age: 5, gender: \"여\", teacher_id: 10, parent_id: 9, kindergarden_id: 9, className: \"병아리반\", classNumber: 1  )\n#김지연 아이\nChild.create(name: \"김헤일리\", age: 5, gender: \"여\", teacher_id: 12, parent_id: 11, kindergarden_id: 9, className: \"병아리반\", classNumber: 1  )\n\nrequire 'nokogiri'\nrequire 'open-uri'\n\n# 서울특별시 종로구(1) ~ 서울특별시 강동구(25)\n(1...25).each do |number|\n    arcode = Region.find(number).arcode.to_s\n    \n    doc = Nokogiri::XML(open(\"http://api.childcare.go.kr/mediate/rest/cpmsapi030/cpmsapi030/request?key=08b5b6f754264e40bd3018ca28921360&arcode=\" + arcode + \"&stcode=\"))\n    \n    # item 파싱\n    item = doc.xpath(\"//item\")\n    \n    counter = 0\n    # item 내부 정보 하나씩 꺼내기\n    item.each do |i|\n        Kindergarden.create(sidoname: i.xpath(\"//sidoname\")[counter].inner_text,\n                            sigunguname: i.xpath(\"//sigunname\")[counter].inner_text,\n                            stcode: i.xpath(\"//stcode\")[counter].inner_text,\n                            crname: i.xpath(\"//crname\")[counter].inner_text,\n                            crtypename: i.xpath(\"//crtypename\")[counter].inner_text,\n                            crstatusname: i.xpath(\"//crstatusname\")[counter].inner_text,\n                            zipcode: i.xpath(\"//zipcode\")[counter].inner_text,\n                            craddr: i.xpath(\"//craddr\")[counter].inner_text,\n                            crtelno: i.xpath(\"//crtelno\")[counter].inner_text,\n                            crfaxno: i.xpath(\"//crfaxno\")[counter].inner_text,\n                            crhome: i.xpath(\"//crhome\")[counter].inner_text,\n                            nrtrroomcnt: i.xpath(\"//nrtrroomcnt\")[counter].inner_text,\n                            nrtrroomsize: i.xpath(\"//nrtrroomsize\")[counter].inner_text,\n                            plgrdco: i.xpath(\"//plgrdco\")[counter].inner_text,\n                            chcrtescnt: i.xpath(\"//chcrtescnt\")[counter].inner_text,\n                            crcapat: i.xpath(\"//crcapat\")[counter].inner_text,\n                            crchcnt: i.xpath(\"//crchcnt\")[counter].inner_text,\n                            la: i.xpath(\"//la\")[counter].inner_text,\n                            lo: i.xpath(\"//lo\")[counter].inner_text,\n                            crcargbname: i.xpath(\"//crcargbname\")[counter].inner_text,\n                            crcnfmdt: i.xpath(\"//crcnfmdt\")[counter].inner_text,\n                            crpausebegindt: i.xpath(\"//crpausebegindt\")[counter].inner_text,\n                            crpauseenddt: i.xpath(\"//crpauseenddt\")[counter].inner_text,\n                            crabldt: i.xpath(\"//crabldt\")[counter].inner_text,\n                            crspec: i.xpath(\"//crspec\")[counter].inner_text\n                            )\n                            \n        counter += 1\n    end\nend\n\nrequire 'roo'\n\n# 서울광역시 엑셀 데이터\nxlsx = Roo::Excelx.new(\"./seoul_test.xlsx\")\n# 전체 데이터 2 ~ 2083 중 일부만 시드생성\n(2..150).each do |i|\n    @danger = Danger.new\n    \n    \n    @danger.controlnumber = xlsx.cell(i, 'A')\n    @danger.phone = xlsx.cell(i, 'B')\n    address = xlsx.cell(i, 'C')\n    @danger.zipcode = xlsx.cell(i, 'D')\n    @danger.name = xlsx.cell(i, 'E')\n    @danger.category = xlsx.cell(i, 'F')\n    \n    # () 버리기\n    strStart = address.index('(')\n    @danger.address = address[0..(strStart-1)]\n    \n    res = Naver::Map.geocode(query: @danger.address)\n    # 좌표정보 X와 Y는 위도와 경도가 아니라\n    # 중부원점TM(EPSG:2097) 좌표계에 따른 해당위치의 좌표정보이다.\n    @danger.x = res.x\n    @danger.y = res.y\n    @danger.save\nend","undoManager":{"mark":-1,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":0,"scrollleft":6,"selection":{"start":{"row":5,"column":71},"end":{"row":5,"column":71},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1538384456239}